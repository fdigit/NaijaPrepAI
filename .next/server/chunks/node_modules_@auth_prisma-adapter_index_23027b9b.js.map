{"version":3,"sources":["../../../node_modules/%40auth/prisma-adapter/index.js"],"sourcesContent":["export function PrismaAdapter(prisma) {\n    const p = prisma;\n    return {\n        // We need to let Prisma generate the ID because our default UUID is incompatible with MongoDB\n        createUser: ({ id, ...data }) => p.user.create(stripUndefined(data)),\n        getUser: (id) => p.user.findUnique({ where: { id } }),\n        getUserByEmail: (email) => p.user.findUnique({ where: { email } }),\n        async getUserByAccount(provider_providerAccountId) {\n            const account = await p.account.findUnique({\n                where: { provider_providerAccountId },\n                include: { user: true },\n            });\n            return account?.user ?? null;\n        },\n        updateUser: ({ id, ...data }) => p.user.update({\n            where: { id },\n            ...stripUndefined(data),\n        }),\n        deleteUser: (id) => p.user.delete({ where: { id } }),\n        linkAccount: (data) => p.account.create({ data }),\n        unlinkAccount: (provider_providerAccountId) => p.account.delete({\n            where: { provider_providerAccountId },\n        }),\n        async getSessionAndUser(sessionToken) {\n            const userAndSession = await p.session.findUnique({\n                where: { sessionToken },\n                include: { user: true },\n            });\n            if (!userAndSession)\n                return null;\n            const { user, ...session } = userAndSession;\n            return { user, session };\n        },\n        createSession: (data) => p.session.create(stripUndefined(data)),\n        updateSession: (data) => p.session.update({\n            where: { sessionToken: data.sessionToken },\n            ...stripUndefined(data),\n        }),\n        deleteSession: (sessionToken) => p.session.delete({ where: { sessionToken } }),\n        async createVerificationToken(data) {\n            const verificationToken = await p.verificationToken.create(stripUndefined(data));\n            if (\"id\" in verificationToken && verificationToken.id)\n                delete verificationToken.id;\n            return verificationToken;\n        },\n        async useVerificationToken(identifier_token) {\n            try {\n                const verificationToken = await p.verificationToken.delete({\n                    where: { identifier_token },\n                });\n                if (\"id\" in verificationToken && verificationToken.id)\n                    delete verificationToken.id;\n                return verificationToken;\n            }\n            catch (error) {\n                // If token already used/deleted, just return null\n                // https://www.prisma.io/docs/reference/api-reference/error-reference#p2025\n                if (error &&\n                    typeof error === \"object\" &&\n                    \"code\" in error &&\n                    error.code === \"P2025\")\n                    return null;\n                throw error;\n            }\n        },\n        async getAccount(providerAccountId, provider) {\n            return p.account.findFirst({\n                where: { providerAccountId, provider },\n            });\n        },\n        async createAuthenticator(data) {\n            return p.authenticator.create(stripUndefined(data));\n        },\n        async getAuthenticator(credentialID) {\n            return p.authenticator.findUnique({\n                where: { credentialID },\n            });\n        },\n        async listAuthenticatorsByUserId(userId) {\n            return p.authenticator.findMany({\n                where: { userId },\n            });\n        },\n        async updateAuthenticatorCounter(credentialID, counter) {\n            return p.authenticator.update({\n                where: { credentialID },\n                data: { counter },\n            });\n        },\n    };\n}\n/** @see https://www.prisma.io/docs/orm/prisma-client/special-fields-and-types/null-and-undefined */\nfunction stripUndefined(obj) {\n    const data = {};\n    for (const key in obj)\n        if (obj[key] !== undefined)\n            data[key] = obj[key];\n    return { data };\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}