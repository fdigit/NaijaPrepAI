{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/User/Documents/fDigit%20Technologies/NaijaPrepAI/components/dashboard/DashboardLayout.tsx"],"sourcesContent":["'use client';\n\nimport { useSession, signOut } from 'next-auth/react';\nimport Link from 'next/link';\nimport { usePathname } from 'next/navigation';\nimport { GraduationCap, Home, BookOpen, BarChart3, Settings, LogOut, Menu, X, Sparkles, Calendar, FileText, Trophy } from 'lucide-react';\nimport { useState } from 'react';\n\ninterface DashboardLayoutProps {\n  children: React.ReactNode;\n}\n\nexport default function DashboardLayout({ children }: DashboardLayoutProps) {\n  const { data: session } = useSession();\n  const pathname = usePathname();\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n\n  const navigation = [\n    { name: 'Home', href: '/dashboard', icon: Home },\n    { name: 'Generate Lesson', href: '/dashboard/generate', icon: Sparkles },\n    { name: 'My Lessons', href: '/dashboard/lessons', icon: BookOpen },\n    { name: 'Exam Prep', href: '/dashboard/exam-prep', icon: FileText },\n    { name: 'Study Planner', href: '/dashboard/study-planner', icon: Calendar },\n    { name: 'Gamification', href: '/dashboard/gamification', icon: Trophy },\n    { name: 'Analytics', href: '/dashboard/analytics', icon: BarChart3 },\n    { name: 'Settings', href: '/dashboard/settings', icon: Settings },\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-[#F7F8FA] flex\">\n      {/* Sidebar - Desktop */}\n      <aside className=\"hidden lg:flex lg:flex-col lg:w-64 lg:fixed lg:inset-y-0 lg:z-50\">\n        <div className=\"flex flex-col flex-grow bg-white border-r border-slate-200 pt-5 pb-4 overflow-y-auto\">\n          {/* Logo */}\n          <div className=\"flex items-center flex-shrink-0 px-6 mb-8\">\n            <div className=\"bg-[#00695C] p-2 rounded-lg text-white\">\n              <GraduationCap size={24} />\n            </div>\n            <div className=\"ml-3\">\n              <h1 className=\"text-xl font-bold text-slate-900 tracking-tight\">\n                NaijaPrep<span className=\"text-[#00695C]\">AI</span>\n              </h1>\n              <p className=\"text-xs text-slate-500\">SSCE & BECE Companion</p>\n            </div>\n          </div>\n\n          {/* Navigation */}\n          <nav className=\"flex-1 px-3 space-y-1\">\n            {navigation.map((item) => {\n              const Icon = item.icon;\n              const isActive = pathname === item.href || (item.href !== '/dashboard' && pathname?.startsWith(item.href));\n              return (\n                <Link\n                  key={item.name}\n                  href={item.href}\n                  className={`flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors ${\n                    isActive\n                      ? 'bg-[#00695C] text-white'\n                      : 'text-slate-700 hover:bg-slate-100 hover:text-[#00695C]'\n                  }`}\n                >\n                  <Icon size={20} />\n                  {item.name}\n                </Link>\n              );\n            })}\n          </nav>\n\n          {/* User Section */}\n          <div className=\"flex-shrink-0 border-t border-slate-200 p-4\">\n            <div className=\"flex items-center gap-3 mb-3\">\n              {session?.user?.image && (\n                <img\n                  src={session.user.image}\n                  alt={session.user.name || 'User'}\n                  className=\"w-10 h-10 rounded-full\"\n                />\n              )}\n              <div className=\"flex-1 min-w-0\">\n                <p className=\"text-sm font-medium text-slate-900 truncate\">\n                  {session?.user?.name || 'Student'}\n                </p>\n                <p className=\"text-xs text-slate-500 truncate\">\n                  {session?.user?.email}\n                </p>\n              </div>\n            </div>\n            <button\n              onClick={() => signOut({ callbackUrl: '/' })}\n              className=\"w-full flex items-center gap-2 px-3 py-2 text-sm text-slate-600 hover:text-slate-900 hover:bg-slate-50 rounded-lg transition-colors\"\n            >\n              <LogOut size={18} />\n              Sign Out\n            </button>\n          </div>\n        </div>\n      </aside>\n\n      {/* Main Content Area */}\n      <div className=\"flex-1 flex flex-col lg:pl-64\">\n        {/* Mobile Header */}\n        <header className=\"lg:hidden bg-white border-b border-slate-200 sticky top-0 z-50\">\n          <div className=\"px-4 sm:px-6\">\n            <div className=\"flex items-center justify-between h-16\">\n              <div className=\"flex items-center gap-2\">\n                <div className=\"bg-[#00695C] p-2 rounded-lg text-white\">\n                  <GraduationCap size={20} />\n                </div>\n                <div>\n                  <h1 className=\"text-lg font-bold text-slate-900\">\n                    NaijaPrep<span className=\"text-[#00695C]\">AI</span>\n                  </h1>\n                </div>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                {session && (\n                  <button\n                    onClick={() => signOut({ callbackUrl: '/' })}\n                    className=\"p-2 text-slate-600 hover:text-slate-900 hover:bg-slate-50 rounded-lg transition-colors\"\n                    title=\"Sign Out\"\n                  >\n                    <LogOut size={20} />\n                  </button>\n                )}\n                <button\n                  onClick={() => setMobileMenuOpen(!mobileMenuOpen)}\n                  className=\"p-2 text-slate-600\"\n                >\n                  {mobileMenuOpen ? <X size={24} /> : <Menu size={24} />}\n                </button>\n              </div>\n            </div>\n          </div>\n\n          {/* Mobile Navigation */}\n          {mobileMenuOpen && (\n            <div className=\"border-t border-slate-200 bg-white\">\n              <nav className=\"px-4 py-4 space-y-2\">\n                {navigation.map((item) => {\n                  const Icon = item.icon;\n                  const isActive = pathname === item.href || (item.href !== '/dashboard' && pathname?.startsWith(item.href));\n                  return (\n                    <Link\n                      key={item.name}\n                      href={item.href}\n                      onClick={() => setMobileMenuOpen(false)}\n                      className={`flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-medium transition-colors ${\n                        isActive\n                          ? 'bg-[#00695C] text-white'\n                          : 'text-slate-600 hover:bg-slate-50'\n                      }`}\n                    >\n                      <Icon size={20} />\n                      {item.name}\n                    </Link>\n                  );\n                })}\n                <div className=\"pt-4 border-t border-slate-200\">\n                  <div className=\"flex items-center gap-3 px-4 mb-3\">\n                    {session?.user?.image && (\n                      <img\n                        src={session.user.image}\n                        alt={session.user.name || 'User'}\n                        className=\"w-8 h-8 rounded-full\"\n                      />\n                    )}\n                    <div className=\"flex-1 min-w-0\">\n                      <p className=\"text-sm font-medium text-slate-900 truncate\">\n                        {session?.user?.name || 'Student'}\n                      </p>\n                    </div>\n                  </div>\n                  <button\n                    onClick={() => {\n                      signOut();\n                      setMobileMenuOpen(false);\n                    }}\n                    className=\"w-full flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-medium text-slate-600 hover:bg-slate-50\"\n                  >\n                    <LogOut size={20} />\n                    Sign Out\n                  </button>\n                </div>\n              </nav>\n            </div>\n          )}\n        </header>\n\n        {/* Main Content */}\n        <main className=\"flex-1\">{children}</main>\n\n        {/* Footer */}\n        <footer className=\"bg-white border-t border-slate-200 py-8 mt-12\">\n          <div className=\"max-w-7xl mx-auto px-4 text-center text-slate-500 text-sm\">\n            <p>Â© {new Date().getFullYear()} NaijaPrep AI. Content aligned with NERDC Curriculum.</p>\n          </div>\n        </footer>\n      </div>\n    </div>\n  );\n}\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 549, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/User/Documents/fDigit%20Technologies/NaijaPrepAI/constants.ts"],"sourcesContent":["import { SubjectOption } from './types';\n\nexport const AVAILABLE_SUBJECTS: SubjectOption[] = [\n  { id: 'math', name: 'Mathematics', categories: ['general'] },\n  { id: 'eng', name: 'English Language', categories: ['general'] },\n  { id: 'phy', name: 'Physics', categories: ['science'] },\n  { id: 'chem', name: 'Chemistry', categories: ['science'] },\n  { id: 'bio', name: 'Biology', categories: ['science'] },\n  { id: 'agric', name: 'Agricultural Science', categories: ['science', 'general'] },\n  { id: 'econ', name: 'Economics', categories: ['commercial', 'art', 'science'] },\n  { id: 'govt', name: 'Government', categories: ['art', 'commercial'] },\n  { id: 'lit', name: 'Literature-in-English', categories: ['art'] },\n  { id: 'crk', name: 'CRS', categories: ['art'] },\n  { id: 'geo', name: 'Geography', categories: ['science', 'art'] },\n  { id: 'comm', name: 'Commerce', categories: ['commercial'] },\n  { id: 'acct', name: 'Financial Accounting', categories: ['commercial'] },\n  { id: 'civic', name: 'Civic Education', categories: ['general'] },\n  { id: 'comp', name: 'Computer Studies', categories: ['science', 'general'] },\n  { id: 'bst', name: 'Basic Science', categories: ['general'] }, // JSS\n  { id: 'btech', name: 'Basic Technology', categories: ['general'] }, // JSS\n  { id: 'sos', name: 'Social Studies', categories: ['general'] }, // JSS\n  { id: 'phe', name: 'P.H.E.', categories: ['general'] },\n];\n\nexport const WEEKS = Array.from({ length: 13 }, (_, i) => i + 1);\n\nexport const DEFAULT_TOPIC_PLACEHOLDERS: Record<string, string> = {\n  'math': 'e.g. Quadratic Equations, Indices, Geometry',\n  'phy': 'e.g. Motion, Electricity, Hooke\\'s Law',\n  'eng': 'e.g. Parts of Speech, Essay Writing, Oral English',\n  'default': 'Enter the specific topic from your scheme of work',\n};"],"names":[],"mappings":";;;;;;;;AAEO,MAAM,qBAAsC;IACjD;QAAE,IAAI;QAAQ,MAAM;QAAe,YAAY;YAAC;SAAU;IAAC;IAC3D;QAAE,IAAI;QAAO,MAAM;QAAoB,YAAY;YAAC;SAAU;IAAC;IAC/D;QAAE,IAAI;QAAO,MAAM;QAAW,YAAY;YAAC;SAAU;IAAC;IACtD;QAAE,IAAI;QAAQ,MAAM;QAAa,YAAY;YAAC;SAAU;IAAC;IACzD;QAAE,IAAI;QAAO,MAAM;QAAW,YAAY;YAAC;SAAU;IAAC;IACtD;QAAE,IAAI;QAAS,MAAM;QAAwB,YAAY;YAAC;YAAW;SAAU;IAAC;IAChF;QAAE,IAAI;QAAQ,MAAM;QAAa,YAAY;YAAC;YAAc;YAAO;SAAU;IAAC;IAC9E;QAAE,IAAI;QAAQ,MAAM;QAAc,YAAY;YAAC;YAAO;SAAa;IAAC;IACpE;QAAE,IAAI;QAAO,MAAM;QAAyB,YAAY;YAAC;SAAM;IAAC;IAChE;QAAE,IAAI;QAAO,MAAM;QAAO,YAAY;YAAC;SAAM;IAAC;IAC9C;QAAE,IAAI;QAAO,MAAM;QAAa,YAAY;YAAC;YAAW;SAAM;IAAC;IAC/D;QAAE,IAAI;QAAQ,MAAM;QAAY,YAAY;YAAC;SAAa;IAAC;IAC3D;QAAE,IAAI;QAAQ,MAAM;QAAwB,YAAY;YAAC;SAAa;IAAC;IACvE;QAAE,IAAI;QAAS,MAAM;QAAmB,YAAY;YAAC;SAAU;IAAC;IAChE;QAAE,IAAI;QAAQ,MAAM;QAAoB,YAAY;YAAC;YAAW;SAAU;IAAC;IAC3E;QAAE,IAAI;QAAO,MAAM;QAAiB,YAAY;YAAC;SAAU;IAAC;IAC5D;QAAE,IAAI;QAAS,MAAM;QAAoB,YAAY;YAAC;SAAU;IAAC;IACjE;QAAE,IAAI;QAAO,MAAM;QAAkB,YAAY;YAAC;SAAU;IAAC;IAC7D;QAAE,IAAI;QAAO,MAAM;QAAU,YAAY;YAAC;SAAU;IAAC;CACtD;AAEM,MAAM,QAAQ,MAAM,IAAI,CAAC;IAAE,QAAQ;AAAG,GAAG,CAAC,GAAG,IAAM,IAAI;AAEvD,MAAM,6BAAqD;IAChE,QAAQ;IACR,OAAO;IACP,OAAO;IACP,WAAW;AACb"}},
    {"offset": {"line": 711, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/User/Documents/fDigit%20Technologies/NaijaPrepAI/types.ts"],"sourcesContent":["export enum ClassLevel {\n  JSS1 = \"JSS 1\",\n  JSS2 = \"JSS 2\",\n  JSS3 = \"JSS 3\",\n  SSS1 = \"SSS 1\",\n  SSS2 = \"SSS 2\",\n  SSS3 = \"SSS 3\",\n}\n\nexport enum Term {\n  FIRST = \"First Term\",\n  SECOND = \"Second Term\",\n  THIRD = \"Third Term\",\n}\n\nexport interface SelectionState {\n  classLevel: ClassLevel;\n  subject: string;\n  term: Term;\n  week: number;\n  topic: string; // User can type a specific topic or let AI infer from curriculum standard\n}\n\nexport interface MCQ {\n  question: string;\n  options: string[];\n  correctOptionIndex: number;\n  explanation: string;\n}\n\nexport interface TheoryQuestion {\n  question: string;\n  answer: string;\n}\n\nexport interface LessonContent {\n  topicTitle: string;\n  introduction: string;\n  mainContent: string; // Markdown supported\n  summaryPoints: string[];\n  practiceQuestions: MCQ[];\n  theoryQuestion: TheoryQuestion;\n}\n\nexport type SubjectOption = {\n  id: string;\n  name: string;\n  categories: ('science' | 'art' | 'commercial' | 'general')[];\n};\n\nexport interface ExamQuestion {\n  question: string;\n  options: string[];\n  correctOptionIndex: number;\n  explanation: string;\n  topicCovered: string;\n  difficulty: 'easy' | 'medium' | 'hard';\n}\n\nexport interface ExamPrepData {\n  subject: string;\n  classLevel: ClassLevel;\n  examName?: string;\n  questionCount?: number;\n}"],"names":[],"mappings":";;;;;;AAAO,IAAA,AAAK,oCAAA;;;;;;;WAAA;;AASL,IAAA,AAAK,8BAAA;;;;WAAA"}},
    {"offset": {"line": 736, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/User/Documents/fDigit%20Technologies/NaijaPrepAI/components/CurriculumForm.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { AVAILABLE_SUBJECTS, WEEKS, DEFAULT_TOPIC_PLACEHOLDERS } from '../constants';\nimport { ClassLevel, Term, SelectionState } from '../types';\nimport { Sparkles, Loader2 } from 'lucide-react';\n\ninterface CurriculumFormProps {\n  onGenerate: (selection: SelectionState) => void;\n  isLoading: boolean;\n  initialClassLevel?: ClassLevel | null;\n  initialSubject?: string;\n}\n\nconst CurriculumForm: React.FC<CurriculumFormProps> = ({ \n  onGenerate, \n  isLoading,\n  initialClassLevel,\n  initialSubject,\n}) => {\n  const [classLevel, setClassLevel] = useState<ClassLevel>(\n    initialClassLevel || ClassLevel.SSS1\n  );\n  const [subject, setSubject] = useState<string>(\n    initialSubject || AVAILABLE_SUBJECTS[0].id\n  );\n  const [term, setTerm] = useState<Term>(Term.FIRST);\n  const [week, setWeek] = useState<number>(1);\n  const [topic, setTopic] = useState<string>('');\n\n  // Update form when initial values change\n  useEffect(() => {\n    if (initialClassLevel) {\n      setClassLevel(initialClassLevel);\n    }\n  }, [initialClassLevel]);\n\n  useEffect(() => {\n    if (initialSubject) {\n      setSubject(initialSubject);\n    }\n  }, [initialSubject]);\n\n  // Helper to find subject name for placeholder logic\n  const selectedSubjectObj = AVAILABLE_SUBJECTS.find(s => s.id === subject);\n  const placeholder = selectedSubjectObj \n    ? DEFAULT_TOPIC_PLACEHOLDERS[selectedSubjectObj.id] || DEFAULT_TOPIC_PLACEHOLDERS['default']\n    : DEFAULT_TOPIC_PLACEHOLDERS['default'];\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    const subName = AVAILABLE_SUBJECTS.find(s => s.id === subject)?.name || subject;\n    onGenerate({\n      classLevel,\n      subject: subName,\n      term,\n      week,\n      topic: topic.trim() || `Week ${week} Topic`, // Fallback if user leaves empty\n    });\n  };\n\n  return (\n    <div className=\"bg-white rounded-xl shadow-sm border border-slate-200 p-6 md:p-8\">\n      <div className=\"mb-6\">\n        <h2 className=\"text-xl font-bold text-slate-900\">Curriculum Selector</h2>\n        <p className=\"text-slate-500 text-sm\">Choose your class and topic to generate a lesson plan.</p>\n      </div>\n\n      <form onSubmit={handleSubmit} className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n        <div className=\"space-y-2\">\n          <label className=\"text-xs font-semibold uppercase tracking-wide text-slate-500\">Class Level</label>\n          <div className=\"relative\">\n            <select\n              className=\"w-full appearance-none bg-slate-50 border border-slate-200 text-slate-900 text-sm rounded-lg focus:ring-green-500 focus:border-green-500 block p-3\"\n              value={classLevel}\n              onChange={(e) => setClassLevel(e.target.value as ClassLevel)}\n            >\n              {Object.values(ClassLevel).map((lvl) => (\n                <option key={lvl} value={lvl}>{lvl}</option>\n              ))}\n            </select>\n          </div>\n        </div>\n\n        <div className=\"space-y-2\">\n          <label className=\"text-xs font-semibold uppercase tracking-wide text-slate-500\">Subject</label>\n          <select\n            className=\"w-full bg-slate-50 border border-slate-200 text-slate-900 text-sm rounded-lg focus:ring-green-500 focus:border-green-500 block p-3\"\n            value={subject}\n            onChange={(e) => setSubject(e.target.value)}\n          >\n            {AVAILABLE_SUBJECTS.map((sub) => (\n              <option key={sub.id} value={sub.id}>{sub.name}</option>\n            ))}\n          </select>\n        </div>\n\n        <div className=\"space-y-2\">\n          <label className=\"text-xs font-semibold uppercase tracking-wide text-slate-500\">Term</label>\n          <select\n            className=\"w-full bg-slate-50 border border-slate-200 text-slate-900 text-sm rounded-lg focus:ring-green-500 focus:border-green-500 block p-3\"\n            value={term}\n            onChange={(e) => setTerm(e.target.value as Term)}\n          >\n            {Object.values(Term).map((t) => (\n              <option key={t} value={t}>{t}</option>\n            ))}\n          </select>\n        </div>\n\n        <div className=\"space-y-2\">\n          <label className=\"text-xs font-semibold uppercase tracking-wide text-slate-500\">Week</label>\n          <select\n            className=\"w-full bg-slate-50 border border-slate-200 text-slate-900 text-sm rounded-lg focus:ring-green-500 focus:border-green-500 block p-3\"\n            value={week}\n            onChange={(e) => setWeek(Number(e.target.value))}\n          >\n            {WEEKS.map((w) => (\n              <option key={w} value={w}>Week {w}</option>\n            ))}\n          </select>\n        </div>\n\n        {/* Specific Topic Input - Spans full width on mobile, 2 cols on desktop */}\n        <div className=\"md:col-span-2 lg:col-span-3 space-y-2\">\n          <label className=\"text-xs font-semibold uppercase tracking-wide text-slate-500\">Topic (Optional but Recommended)</label>\n          <input\n            type=\"text\"\n            placeholder={placeholder}\n            value={topic}\n            onChange={(e) => setTopic(e.target.value)}\n            className=\"w-full bg-slate-50 border border-slate-200 text-slate-900 text-sm rounded-lg focus:ring-green-500 focus:border-green-500 block p-3 placeholder-slate-400\"\n          />\n        </div>\n\n        <div className=\"md:col-span-2 lg:col-span-1 flex items-end\">\n          <button\n            type=\"submit\"\n            disabled={isLoading}\n            className=\"w-full flex items-center justify-center gap-2 text-white bg-green-600 hover:bg-green-700 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-3 focus:outline-none transition-all disabled:opacity-70 disabled:cursor-not-allowed\"\n          >\n            {isLoading ? (\n              <>\n                <Loader2 className=\"animate-spin\" size={18} />\n                <span>Generating...</span>\n              </>\n            ) : (\n              <>\n                <Sparkles size={18} />\n                <span>Generate Lesson</span>\n              </>\n            )}\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport default CurriculumForm;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1182, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/User/Documents/fDigit%20Technologies/NaijaPrepAI/services/geminiService.ts"],"sourcesContent":["import { GoogleGenAI, Type } from \"@google/genai\";\nimport { LessonContent, SelectionState, ExamQuestion } from \"../types\";\nimport { AggregatedContent } from \"./examPrepService\";\nimport { ClassLevel } from \"@prisma/client\";\n\nconst ai = new GoogleGenAI({ apiKey: process.env.GEMINI_API_KEY || process.env.API_KEY });\n\nexport const generateLessonPlan = async (selection: SelectionState): Promise<LessonContent> => {\n  const modelId = \"gemini-2.5-flash\"; // Using Flash for speed and efficiency with large text generation\n\n  const prompt = `\n    Create a comprehensive Nigerian curriculum (NERDC) aligned lesson plan.\n    \n    Context:\n    - Class: ${selection.classLevel}\n    - Subject: ${selection.subject}\n    - Term: ${selection.term}\n    - Week: ${selection.week}\n    - Specific Topic: ${selection.topic}\n\n    Requirements:\n    1. **Lesson Notes**: Detailed, academic tone, approx 800-1000 words. Use Markdown for formatting (headers, bold, lists). Include definitions, formulas (if applicable), and examples relevant to the Nigerian context.\n    2. **Summary**: 3-5 concise bullet points for revision.\n    3. **Practice Questions**: 5 Multiple Choice Questions (MCQs) with 4 options (A-D) and one correct answer with explanation.\n    4. **Theory Question**: 1 structured theory question with a detailed model answer.\n\n    Format the response as a structured JSON object.\n  `;\n\n  try {\n    const response = await ai.models.generateContent({\n      model: modelId,\n      contents: prompt,\n      config: {\n        responseMimeType: \"application/json\",\n        responseSchema: {\n          type: Type.OBJECT,\n          properties: {\n            topicTitle: { type: Type.STRING, description: \"The formal title of the lesson\" },\n            introduction: { type: Type.STRING, description: \"A brief introductory paragraph\" },\n            mainContent: { type: Type.STRING, description: \"Full lesson notes in Markdown format\" },\n            summaryPoints: {\n              type: Type.ARRAY,\n              items: { type: Type.STRING },\n              description: \"List of key takeaways\"\n            },\n            practiceQuestions: {\n              type: Type.ARRAY,\n              items: {\n                type: Type.OBJECT,\n                properties: {\n                  question: { type: Type.STRING },\n                  options: {\n                    type: Type.ARRAY,\n                    items: { type: Type.STRING },\n                    description: \"Array of 4 options\"\n                  },\n                  correctOptionIndex: { type: Type.INTEGER, description: \"0-3 index of correct option\" },\n                  explanation: { type: Type.STRING, description: \"Why this answer is correct\" }\n                },\n                required: [\"question\", \"options\", \"correctOptionIndex\", \"explanation\"]\n              },\n              description: \"5 MCQs\"\n            },\n            theoryQuestion: {\n              type: Type.OBJECT,\n              properties: {\n                question: { type: Type.STRING },\n                answer: { type: Type.STRING, description: \"Detailed model answer\" }\n              },\n              required: [\"question\", \"answer\"]\n            }\n          },\n          required: [\"topicTitle\", \"introduction\", \"mainContent\", \"summaryPoints\", \"practiceQuestions\", \"theoryQuestion\"]\n        }\n      }\n    });\n\n    if (response.text) {\n      return JSON.parse(response.text) as LessonContent;\n    }\n    throw new Error(\"No content generated\");\n  } catch (error) {\n    console.error(\"Gemini API Error:\", error);\n    throw error;\n  }\n};\n\n/**\n * Generate comprehensive exam questions from aggregated lesson content\n */\nexport const generateExamQuestions = async (\n  subject: string,\n  classLevel: ClassLevel,\n  aggregatedContent: AggregatedContent,\n  questionCount: number = 50\n): Promise<ExamQuestion[]> => {\n  const modelId = \"gemini-2.5-flash\";\n\n  // Build content summary for prompt\n  const contentSummary = aggregatedContent.fullContent.length > 10000\n    ? aggregatedContent.fullContent.substring(0, 10000) + \"\\n\\n[Content truncated for length...]\"\n    : aggregatedContent.fullContent;\n\n  const prompt = `\nYou are an expert Nigerian curriculum (NERDC) exam question generator specializing in Computer-Based Test (CBT) format questions.\n\nContext:\n- Subject: ${subject}\n- Class Level: ${classLevel}\n- Total Lessons Analyzed: ${aggregatedContent.lessonCount}\n- Topics Covered: ${aggregatedContent.topics.join(\", \")}\n\nLesson Content Summary:\n${contentSummary}\n\nKey Summary Points:\n${aggregatedContent.summaryPoints.slice(0, 20).join(\"\\n- \")}\n\nRequirements:\n1. Generate ${questionCount} comprehensive CBT (Computer-Based Test) questions\n2. Questions MUST cover ALL topics from the provided lessons: ${aggregatedContent.topics.join(\", \")}\n3. Difficulty distribution:\n   - 30% easy questions (basic recall and understanding)\n   - 50% medium questions (application and analysis)\n   - 20% hard questions (synthesis and evaluation)\n4. Each question should:\n   - Test understanding, not just memorization\n   - Be relevant to Nigerian curriculum standards (NERDC)\n   - Have exactly 4 options (A, B, C, D)\n   - Include a detailed explanation of why the correct answer is right\n   - Reference which topic it covers\n   - Be appropriate for ${classLevel} level\n5. Ensure comprehensive coverage - every major topic should have at least one question\n6. Questions should prepare students for actual WAEC/BECE exams\n7. Avoid duplicate questions or questions too similar to each other\n8. Make questions practical and applicable to real-world scenarios where possible\n\nFormat the response as a JSON array of questions.\n`;\n\n  try {\n    const response = await ai.models.generateContent({\n      model: modelId,\n      contents: prompt,\n      config: {\n        responseMimeType: \"application/json\",\n        responseSchema: {\n          type: Type.ARRAY,\n          items: {\n            type: Type.OBJECT,\n            properties: {\n              question: {\n                type: Type.STRING,\n                description: \"The question text\"\n              },\n              options: {\n                type: Type.ARRAY,\n                items: { type: Type.STRING },\n                description: \"Array of exactly 4 options (A, B, C, D)\"\n              },\n              correctOptionIndex: {\n                type: Type.INTEGER,\n                description: \"Index of correct option (0-3)\"\n              },\n              explanation: {\n                type: Type.STRING,\n                description: \"Detailed explanation of why this answer is correct\"\n              },\n              topicCovered: {\n                type: Type.STRING,\n                description: \"Which topic from the lessons this question covers\"\n              },\n              difficulty: {\n                type: Type.STRING,\n                enum: [\"easy\", \"medium\", \"hard\"],\n                description: \"Difficulty level of the question\"\n              }\n            },\n            required: [\"question\", \"options\", \"correctOptionIndex\", \"explanation\", \"topicCovered\", \"difficulty\"]\n          }\n        }\n      }\n    });\n\n    if (response.text) {\n      const questions = JSON.parse(response.text) as ExamQuestion[];\n      \n      // Validate questions\n      if (!Array.isArray(questions)) {\n        throw new Error(\"AI response is not an array\");\n      }\n\n      // Validate each question has 4 options\n      const invalidQuestions = questions.filter(\n        q => !q.options || q.options.length !== 4\n      );\n      \n      if (invalidQuestions.length > 0) {\n        console.warn(`Warning: ${invalidQuestions.length} questions have invalid option count`);\n      }\n\n      return questions;\n    }\n    throw new Error(\"No content generated\");\n  } catch (error) {\n    console.error(\"Gemini API Error (Exam Questions):\", error);\n    throw error;\n  }\n};"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1430, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/User/Documents/fDigit%20Technologies/NaijaPrepAI/app/dashboard/generate/page.tsx"],"sourcesContent":["'use client';\n\nimport { useSession } from 'next-auth/react';\nimport { redirect } from 'next/navigation';\nimport { useState, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport DashboardLayout from '@/components/dashboard/DashboardLayout';\nimport CurriculumForm from '@/components/CurriculumForm';\nimport { generateLessonPlan } from '@/services/geminiService';\nimport { SelectionState, ClassLevel } from '@/types';\nimport { AlertCircle, Loader2 } from 'lucide-react';\n\ninterface UserProfile {\n  classLevel: ClassLevel | null;\n  preferredSubjects: string[];\n}\n\nexport default function GenerateLessonPage() {\n  const { data: session, status } = useSession();\n  const router = useRouter();\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [userProfile, setUserProfile] = useState<UserProfile | null>(null);\n  const [loadingProfile, setLoadingProfile] = useState(true);\n\n  useEffect(() => {\n    if (status === 'unauthenticated') {\n      redirect('/auth/signin');\n    }\n  }, [status]);\n\n  // Fetch user profile for pre-population\n  useEffect(() => {\n    async function fetchProfile() {\n      if (!session?.user?.id) return;\n      \n      try {\n        const response = await fetch('/api/user/profile');\n        if (response.ok) {\n          const profile = await response.json();\n          setUserProfile({\n            classLevel: profile.classLevel,\n            preferredSubjects: profile.preferredSubjects || [],\n          });\n        }\n      } catch (error) {\n        console.error('Error fetching profile:', error);\n      } finally {\n        setLoadingProfile(false);\n      }\n    }\n\n    if (session?.user?.id) {\n      fetchProfile();\n    }\n  }, [session]);\n\n  const handleGenerate = async (selection: SelectionState) => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const content = await generateLessonPlan(selection);\n      \n      // Save lesson to database (user is logged in)\n      if (!session?.user?.id) {\n        setError('You must be logged in to save lessons. Please sign in and try again.');\n        setLoading(false);\n        return;\n      }\n\n      try {\n        const response = await fetch('/api/lessons', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ selection, content }),\n        });\n        \n        const responseData = await response.json();\n        \n        if (response.ok) {\n          // Redirect to lesson view\n          router.push(`/lessons/${responseData.id}`);\n        } else {\n          console.error('Save error response:', responseData);\n          setError(responseData.error || 'Failed to save lesson. Please try again.');\n          setLoading(false);\n        }\n      } catch (saveError: any) {\n        console.error('Error saving lesson:', saveError);\n        setError(`Failed to save lesson: ${saveError.message || 'Unknown error'}. Please try again.`);\n        setLoading(false);\n      }\n    } catch (err) {\n      setError(\"Failed to generate content. Please check your connection and try again. If the topic is obscure, try being more specific.\");\n      setLoading(false);\n    }\n  };\n\n  if (status === 'loading' || loadingProfile) {\n    return (\n      <DashboardLayout>\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n          <div className=\"flex items-center justify-center min-h-[400px]\">\n            <Loader2 className=\"animate-spin text-[#00695C]\" size={48} />\n          </div>\n        </div>\n      </DashboardLayout>\n    );\n  }\n\n  return (\n    <DashboardLayout>\n      <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        <div className=\"mb-6\">\n          <h1 className=\"text-3xl font-bold text-slate-900 mb-2\">Generate New Lesson</h1>\n          <p className=\"text-slate-600\">\n            Create AI-powered lesson content aligned with the Nigerian curriculum\n          </p>\n        </div>\n\n        {error && (\n          <div className=\"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center gap-3\">\n            <AlertCircle size={20} />\n            <p>{error}</p>\n          </div>\n        )}\n\n        <CurriculumForm\n          onGenerate={handleGenerate}\n          isLoading={loading}\n          initialClassLevel={userProfile?.classLevel}\n          initialSubject={userProfile?.preferredSubjects?.[0]}\n        />\n      </div>\n    </DashboardLayout>\n  );\n}\n\n"],"names":[],"mappings":"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"}}]
}